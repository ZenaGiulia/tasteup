
<!-- Image de la recette -->
<div class="container-fluid">
  <div class="row">
    <div class="col-12 px-0" id="img-banner">
      <% if @recipe.photo.attached? %>
        <%= cl_image_tag @recipe.photo.key, { class: "img-fluid", style: "height: 200px; width: 100%; object-fit: cover;" } %>
      <% else %>
        <%= image_tag "https://placehold.co/600x400", class: "img-fluid", style: "height: 200px; width: 100%; object-fit: cover;"  %>
      <% end %>
      <div id="back" class="white-button rounded-circle">
        <!-- Modifier le lien avec javascript:history.back() à la place de my_recipes_path si on veut renvoyer vers la page précédente -->
        <%= link_to my_recipes_path do %>
          <i class="fa-solid fa-arrow-left" style="color: #000000;"></i>
        <% end %>
      </div>
      <div id="edit" class="red-button rounded-circle">
        <%= link_to edit_recipe_path(@recipe) do %>
          <i class="fa-solid fa-pen" style="color: #000000;"></i>
        <% end %>
      </div>
      <div id="delete" class="white-button rounded-circle">
        <%= link_to recipe_path(@recipe), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } do %>
          <i class="fa-solid fa-trash" style="color: #000000;"></i>
        <% end %>
      </div>
    </div>
  </div>
</div>

<!-- Contenu de la recette -->
<div class="container">
  <div class="row text-center mt-3">
    <div class="col-12">
      <h3><%= @recipe.title %></h3>
    </div>
  </div>
  <div class="row text-center justify-content-between mb-3">
    <div class="col-12">
      <% @recipe.categories.each do |categorie|%>
        <span class="badge text-bg-warning p-2 fw-normal"><%= categorie.name %></span>
      <% end %>
    </div>
  </div>
  <div data-controller="tab" class="tabs">
    <div class="button-container mb-4 px-2">
      <ul class="nav nav-pills flex-fill d-flex align-items-center justify-content-evenly px-2">
        <li class="nav-item">
          <button data-action="click->tab#show" data-tab-target="button" data-tab-id-param="1" type="button" class="tab-button on px-3 py-2">Détails</button>
        </li>
        <li class="nav-item">
          <button data-action="click->tab#show" data-tab-target="button" data-tab-id-param="2" type="button" class="tab-button px-3 py-2">Ingrédients</button>
        </li>
        <li class="nav-item">
          <button data-action="click->tab#show" data-tab-target="button" data-tab-id-param="3" type="button" class="tab-button px-3 py-2">Préparations</button>
        </li>
      </ul>
    </div>
    <div>
      <!-- Onglet détail -->
      <div class="tab on" data-tab-target="tab" data-id="1">
        <!-- Temps de préparation -->
        <div class="justify-content-start align-items-center bg-white border rounded-pill p-2 d-flex mb-3">
          <div class="me-3">
            <div class="tiny-square">
              <i class="fa-solid fa-clock" style="color: #000000;"></i>
            </div>
          </div>
          <span>Temps de préparation : <strong><%= @recipe.preparation_time %>min</strong></span>
        </div>
        <!-- Temps de cuisson -->
        <div class="justify-content-start align-items-center bg-white border rounded-pill p-2 d-flex mb-3">
          <div class="me-3">
            <div class="tiny-square">
              <i class="fa-solid fa-stopwatch" style="color: #000000;"></i>
            </div>
          </div>
          <span>Temps de cuisson : <strong><%= @recipe.cooking_time %>min</strong></span>
        </div>
        <!-- Difficulté -->
        <div class="justify-content-start align-items-center bg-white border rounded-pill p-2 d-flex mb-3">
          <div class="me-3">
            <div class="tiny-square">
              <i class="fa-solid fa-utensils" style="color: #000000;"></i>
            </div>
          </div>
          <span>Difficulté : <strong><%= @recipe.difficulty %></strong></span>
        </div>
      </div>
       <!-- Onglet ingrédients -->
      <div class="tab" data-tab-target="tab" data-id="2">
        <div class="d-flex justify-content-around text-center mt-3">
          <span>-</span>
          <span>Nombre de personnes : <strong><%= @recipe.number_of_servings %></strong></span>
          <span>+</span>
        </div>
        <% @recipe.recipe_ingredients.each do |recipe_ingredient|%>
        <div class="d-flex justify-content-between bg-white border rounded-pill py-2 px-3 mt-3">
          <%= recipe_ingredient.ingredient.name.capitalize %>
          <strong><%= recipe_ingredient.quantity_value.to_s.chomp('.0') %> <%= recipe_ingredient.quantity_unit %></strong>
        </div>
        <% end %>
      </div>
      <!-- Onglet préparation -->
      <div class="tab" data-tab-target="tab" data-id="3">
        <div class="container-fluid">
          <div class="row">
          <% @recipe.preparation_steps.each do |preparation_step|%>
          <div class="col-12 d-flex justify-content-center my-3">
            <div class="tiny-square border">
              <p><%= preparation_step.step_number %></p>
            </div>
          </div>
          <div class="col-12 bg-white border rounded-3 py-3 mb-2">
            <%= preparation_step.instruction %>
          </div>
          <% end %>
          </div>
        </div>
      </div>
      <span>Temps de cuisson : <strong><%= @recipe.cooking_time %>min</strong></span>
    </div>
    <!-- Difficulté -->
    <div class="justify-content-start align-items-center bg-white border-salmon rounded-pill p-2 d-flex mb-3">
      <div class="me-3">
        <div class="tiny-square">
          <i class="fa-solid fa-utensils" style="color: #000000;"></i>
        </div>
      </div>
      <span>Difficulté : <strong><%= @recipe.difficulty %></strong></span>
    </div>
  </div>
  <div id="ingredients">
    <h3>Ingredients :</h3>
    <div class="d-flex justify-content-around text-center mt-3">
      <span>-</span>
      <span>Nombre de personnes : <strong><%= @recipe.number_of_servings %></strong></span>
      <span>+</span>
    </div>
    <% @recipe.recipe_ingredients.each do |recipe_ingredient|%>
      <div class="d-flex justify-content-between bg-white border-salmon rounded-pill py-2 px-3 mt-3">
        <%= recipe_ingredient.ingredient.name.capitalize %>
        <strong><%= recipe_ingredient.quantity_value.to_s.chomp('.0') %> <%= recipe_ingredient.quantity_unit %></strong>
      </div>
    <% end %>
  </div>
  <div id="preparation" class="mt-3">
    <h3>Préparation :</h3>
    <div class="row">
      <% @recipe.preparation_steps.each do |preparation_step|%>
        <div class="col-12 d-flex justify-content-center my-3">
          <div class="tiny-square">
            <p><%= preparation_step.step_number %></p>
          </div>
        </div>
        <div class="col-12 mb-3">
          <%= preparation_step.instruction %>
        </div>
      <% end %>
    </div>
  </div>
</div>
